{
  "task_prompt_peg_create_feature_json": "Your task is to interpret a single descriptive sentence and generate a complete feature definition as a single, valid JSON object.\n\n{world_scene_context}\n\n### Sentence to Interpret:\n{sentence}\n\n### Feature Type Menu (for the 'type' key):\n{type_list_str}\n\n### Nature Menu (for the 'natures' key, choose ALL that apply):\n{nature_menu_str}\n\n### Generation Rules:\n- **`name`**: A short, proper name for the feature.\n- **`description`**: A one-sentence atmospheric description.\n- **`type`**: The most logical ID from the Feature Type Menu.\n- **`natures`**: A list of all applicable natures from the Nature Menu.\n- **`dimensions`**: A string describing the feature's size. You must choose a size that fits within one of the available tiers:\n{size_tier_list_str}\n- If the sentence describes a **`CHARACTER`**, your entire response should be a simple JSON like: `{{\"type\": \"CHARACTER\", \"name\": \"The Hooded Figure\"}}`\n\n### Example Response:\n```json\n{example_response}\n```\n\nYour response MUST be ONLY the JSON object.",
  "task_prompt_peg_narrative_beat": "{world_scene_context}\n\nBelow is a summary of other, separate map areas that have already been described. Your task is to continue writing the description for the **current area** only. Your response must be a single, descriptive sentence that builds upon the provided text and adds a physical feature such as a path, room, exterior space, opening, etc. that logically follows the others in the paragraph. DO NOT under any circumstances add an explanation, justification, or chat with the user as this will be placed in the narrative passage being built as well. Focus on larger map features that are navigable or block access, not individual objects in the scene. Avoid overly flowery language, do not begin stories or a narrative, only describe what would be visible in this place.\n\n### Other Described Map Areas:\n{other_features_context}\n\n### Current Area's Description (continue this):\n{context}",
  "task_prompt_peg_character_placement": "Based on the character's profile, the scene's context, and who is already there, choose the most fitting location and starting action for them.\n\n### Scene Context:\n{scene_prompt}\n\n### Character to Place\n- Name: {character_name}\n- Description: {character_description}\n\n### Available Locations in the Scene:\n{location_tags}\n\n### Characters Already Placed:\n{placed_characters_list}\n\nYour response MUST be a single JSON object in this format:\n`{{\"location_tag\": \"<Chosen Location Tag>\", \"action_description\": \"<A one-sentence, third-person description of what the character is doing there.>\"}}`",
  "task_prompt_peg_v3_get_narrative_seed": "You are creating the very basic descriptive outline of a place in a much larger level. Based on the provided context and the specific area name, write a single, evocative sentence to begin the detailed description of this place. Avoid overly flowery language, do not start stories, introduce characters, or have them act in the world. ONLY write the broad description of the place.\n\n{world_scene_context}\n\n### Area to Describe:\n{area_name}\n\nRespond with ONLY a single starting sentence.",
  "task_prompt_peg_v3_choose_parent": "A new feature has just been described in the ongoing narrative. Your task is to decide where it logically connects to.\n\n### Narrative Context:\n{narrative_log}\n\n### New Feature Description (the last sentence):\n\"*{new_feature_sentence}*\"\n\n### Possible Connection Points:\n{parent_options_list}\n\nFrom the list above, choose the single most logical place to attach this new feature. If you have changed your mind and this new feature doesn't fit, respond with ONLY the word `NONE`.",
  "task_prompt_peg_v3_choose_path_target": "A new path-like feature has just been described. Your task is to decide which of the other major areas it logically connects to.\n\n### Narrative Context:\n{narrative_log}\n\n### New Feature Description (the last sentence):\n\"*{new_feature_sentence}*\"\n\n### Possible Destinations:\n{target_options_list}\n\nFrom the list of possible destinations, choose the single most logical place for this new path to lead. Respond with ONLY the name of your chosen destination.",
  "task_prompt_peg_v3_choose_path_source": "You are creating a new, independent path-like feature (e.g., a river, road). Your task is to choose its starting point from the list of available options.\n\n{world_scene_context}\n\n### Possible Starting Points:\n{source_options_list}\n\nFrom the list above, choose the single most logical place for this new path to begin. Respond with ONLY the name of your chosen starting point.",
  "task_prompt_peg_v3_get_initial_features_json": "Based on the world and scene context, invent a list of 2-5 thematic top-level area names that would exist in this location. For each, provide a single, evocative sentence that will be used to kick off its detailed description later. These sentences should not continue the story in the scene, mention characters in it, or have characters act, they are a stage or level for them to interact in.\n\n Your response must be a single JSON object.\n\n{world_scene_context}\n\n### Feature Type Menu:\n{type_list_str}\n\n### Nature Menu:\n{nature_menu_str}\n\n### Size Tiers:\n'small', 'medium', 'large'\n\n### Your Task:\nGenerate a JSON object with a single key, `features`, containing a list of feature objects. Each object must have these keys:\n- `name`: A short, evocative name for the area.\n- `type`: The most logical ID from the Feature Type Menu.\n- `natures`: A list of ALL applicable natures from the Nature Menu.\n- `size_tier`: The area's relative size from the Size Tiers list.\n- `description_sentence`: The single, evocative starting sentence for this area's narrative.\n\n### Example Response:\n```json\n{example_response}\n```",
  "task_prompt_peg_v3_add_feature_to_empty_region": "You are describing the first notable feature within a large, empty geographical area. Your task is to generate a single, descriptive sentence that introduces a new, non-REGION physical feature (such as a building, a natural landmark, a path, etc.) that would logically be found within this region. Focus on a single, significant feature that can serve as a starting point for more detailed descriptions later.\n\n{world_scene_context}\n\n### Region to Describe:\n- Name: {region_name}\n- Description: {region_description}\n\nRespond with ONLY a single descriptive sentence for the new feature.",
  "task_prompt_peg_v3_create_nearby_feature_sentence": "The existing passage describes several areas. Your task is to generate a single sentence that describes a **new, separate building, open space, or area** that could logically exist nearby or adjacent to the existing locations, given the overall scene. Focus on establishing a new distinct feature that is a large map features that is navigable or blocks access, not individual objects in the scene. Avoid overly flowery language, do not create a story or narrative or introduce characters.\n\nIf you believe the described areas are complete and no new features are needed, respond with ONLY the word `NONE`.\n\n{world_scene_context}\n\n### Existing Areas Narrative:\n{all_areas_narrative}\n\nRespond with ONLY a single descriptive sentence for the new nearby feature, or the word `NONE`.",
  "task_prompt_peg_v3_choose_exterior_tile": "You must choose the base terrain that best fits this scene. This tile will fill all the 'empty' space on the map that is not part of a defined feature. You may pick an impassible tile if you wish the scene to be set indoors or underground, or a walkable tile if the scene is indoors but you expect characters might need to leave. Based on the scene prompt, choose the most thematically appropriate tile from the list below.\n\n### Scene Prompt:\n{scene_prompt}\n\n### Available Tile Types:\n{tile_options_str}\n\nRespond with ONLY the chosen tile's ID name from the list (e.g., `DEFAULT_FLOOR`, `GRASS`, etc.).",
  "task_prompt_peg_v3_decide_connector_strategy": "A new connector (e.g., a hallway, archway) has been proposed. Your task is to decide how to place it.\n\n{world_scene_context}\n\n### Connector Details:\n- Name: {connector_name}\n- Description: {connector_description}\n\n### Option 1: Bridge to an existing, nearby feature.\n{nearby_targets_list}\n\n### Option 2: Create a new, unseen feature.\n\nChoose the best strategy. If you choose Option 1, respond with the name of the target feature. If you choose Option 2, respond with the keyword `CREATE_NEW`.",
  "task_prompt_peg_v3_create_connector_child": "You are continuing an environmental description. The text so far describes one area, and a passage leading away from it. Your task is to write the next single sentence, describing the new area the passage leads to.\n\n{world_scene_context}\n\n### Context:\n- **Starting Area:** {starting_area_description}\n- **Connector:** A {connector_name} ({connector_description}) leads away from here.\n\nRespond with ONLY a single, new descriptive sentence for the area at the end of the connector.",
  "task_prompt_peg_choose_placement_keyword": "A new feature has been described. Your task is to choose the single most logical way to place it relative to the current area being described.\n\n{world_scene_context}\n\n### Narrative Context:\n{narrative_log}\n\n### New Feature Description (the last sentence):\n\"*{new_feature_sentence}*\"\n\n### Placement Strategies:\n- **INSIDE**: Places the new feature *within* the current area. Use for rooms inside a building, or a clearing inside a forest.\n- **OUTSIDE**: Places the new feature directly attached to the *exterior* of the current area. Use for a lean-to against a house, or a porch on a building.\n- **NEARBY**: Places the new feature close to, but not touching, the current area. Use for separate but related locations, like a shed near a farmhouse.\n{region_option_text}\n\nRespond with ONLY the chosen keyword (e.g., `INSIDE`).",
  "task_prompt_peg_choose_branches_for_region": "You have created a new large geographical Region: **{new_region_name}**. The current area, **{narrative_branch_name}**, will automatically be included in this region. \n\nYour task is to choose which, if any, of the other existing, separate areas should also be grouped into this new region.\n\n{world_scene_context}\n\n### Other Available Areas:\n{available_branches_list}\n\nIf you want to group other areas, respond with a semicolon-separated list of their names. If only **{narrative_branch_name}** should be in this region, respond with ONLY the word `NONE`.",
  "task_prompt_peg_choose_interior_location": "An item or character needs to be placed inside one of the existing locations. Based on the item/character and the location descriptions, choose the most logical container.\n\n{world_scene_context}\n\n### Item/Character to Place:\n- Name: {feature_name}\n- Description: {feature_description}\n\n### Available Container Locations:\n{container_list}\n\n### Your Task:\nRespond with ONLY the name of the chosen location from the list above. If no location is suitable, respond with `NONE`.",
  "task_prompt_peg_assign_features_to_regions": "You are a world designer organizing a new map area. Below are the major geographical regions that have been defined, and a list of smaller points of interest. Your task is to assign each point of interest to the single most logical region it would be found in.\n\n{world_scene_context}\n\n### Regions:\n{regions_list_str}\n\n### Points of Interest:\n{features_list_str}\n\nYour response MUST be a single JSON object where each key is a point of interest name and its value is the name of the region it belongs to.\n\n### Example Response:\n```json\n{{\n  \"The Old Well\": \"Sun-scorched Fields\",\n  \"Abandoned Farmhouse\": \"Sun-scorched Fields\",\n  \"Whispering Cave Entrance\": \"Whispering Woods\"\n}}\n```"
}