{
    "task_prompt_ch_fix_initial_equipment_json": "The following text was meant to be a JSON object containing a list of equipment, but it is broken. Your task is to fix it.\n\n### Rules:\n- The top-level object must have one key: `items`.\n- The `items` key must contain a list of objects.\n- Each object in the list must have two string keys: `name` and `description`.\n- If you cannot extract the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_individual_actions_json": "The following text was meant to be a JSON object where keys are character names and values are their actions, but it is broken. Your task is to fix it.\n\n### Rules:\n- The entire response must be a single JSON object.\n- Each key must be a character's full name from the list.\n- Each value must be a string describing their action.\n- If you cannot extract any valid data, return an empty JSON object: `{{}}`.\n\n### Valid Character Names:\n{character_list}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_group_placement_json": "The following text was meant to be a JSON object with a single key `location_tag`, but it is broken. Your task is to fix it.\n\n### Rules:\n- The JSON must have one key: `location_tag`.\n- The value must be a single string from the list of valid locations.\n- If you cannot extract a valid location, return an empty JSON object: `{{}}`.\n\n### Valid Location Tags:\n{valid_location_tags}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_full_lead_json": "The following text was supposed to be a single JSON object for a new lead character profile, but it is broken. Your task is to extract the intended data and fix the JSON.\n\n### Rules:\n- The JSON must have five keys: `name`, `description`, `physical_description`, `instructions`, and `persona_description`.\n- All keys and values must be strings.\n- If you cannot determine the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_lead_roles_json": "The following text was supposed to be a single JSON object containing grouped character roles, but it is broken. Your task is to fix it.\n\n### Rules:\n- The top-level object must have one key: `groups`.\n- The `groups` key must contain a list of group objects.\n- Each group object must have two keys: `group_description` (a string) and `roles` (a list of strings).\n- If you cannot extract any valid data, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_synthesized_dm_json": "The following text was meant to be a single JSON object describing a new, synthesized Game Master persona, but it's broken. Your task is to fix it.\n\n### Rules:\n- The JSON must have four keys: `name`, `description`, `instructions`, and `persona_description`.\n- All keys and values must be strings.\n- If you cannot extract the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_full_char_json": "The following text was supposed to be a single JSON object for a new character profile, but it is broken. Your task is to extract the intended data and fix the JSON.\n\n### Rules:\n- The JSON must have five keys: `name`, `description`, `physical_description`, `instructions`, and `persona_description`.\n- All keys and values must be strings.\n- If you cannot determine the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_director": "The following text was supposed to be a single JSON object for a story Director, but it is broken. Your task is to extract the intended command and fix the JSON. \n\n### Rules:\n- The 'action' key must be one of 'UPDATE', 'REMOVE', or 'LOAD'.\n- For 'UPDATE', the 'new_instructions' key must contain the new text.\n- For 'REMOVE', 'replacement_type' must be 'PROMOTE' or 'CREATE'.\n- For 'LOAD', 'target_name' must be a character name.\n- If you cannot determine a command, return an empty JSON object: `{{}}`.\n\n### Available for Casting:\n{casting_list_str}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_peg_json": "The following text was meant to be a JSON object for a map generator, but it is broken. Your task is to fix it.\n\n### Rules:\n- The 'type' key MUST be one of the options from the 'Grammar Menu'.\n- All keys (`name`, `description`, `type`, `dimensions`) must be present.\n- If you cannot determine a valid feature, return an empty JSON object: `{{}}`.\n\n### Grammar Menu:\n{type_list_str}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_npc_json_from_procgen": "The following text was meant to be a JSON object describing a new character, but it is broken. Your task is to fix it.\n\n### Rules:\n- The JSON must have three keys: `name`, `description`, and `instructions`.\n- All keys and values must be strings.\n- If you cannot extract the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_atlas": "The following text was meant to be a JSON object describing a new world location, but it is broken. Your task is to fix it.\n\n### Rules:\n- The JSON must have three keys: `Name`, `Description`, and `Type`.\n- All keys and values must be strings.\n- If you cannot extract the required information, return an empty JSON object: `{{}}`.\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_command_handler_fix_movement": "The following text was supposed to be a JSON command for character movement, but it failed. Your task is to extract the intended movement and format it correctly. \n\n### Rules:\n- The `target` MUST be one of the names from the 'Valid Targets' list.\n- If you cannot determine a clear move command, return an empty JSON object: `{{}}`.\n\n### Valid Targets in the Scene:\n{target_list}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your JSON Output:",
    "task_prompt_ch_fix_peg_v2_json": "The following text was meant to be a JSON object defining a map area, but it is broken. Your task is to fix it.\n\n### Rules:\n- The JSON must have three keys: `description`, `type`, and `size_tier`.\n- The `type` must be one of the options from the menu.\n- The `size_tier` must be 'small', 'medium', or 'large'.\n- If you cannot extract the required information, return an empty JSON object: `{{}}`.\n\n### Feature Type Menu:\n{type_list_str}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_peg_v3_json": "The following text was meant to be a JSON object defining the initial areas for a map, but it's broken. Your task is to fix it.\n\n### Rules:\n- The top-level object must have one key: `features`.\n- The `features` key must contain a list of objects.\n- Each object in the list must have the keys: `name`, `type`, `size_tier`, and `description_sentence`.\n- The `type` must be one of the options from the menu.\n- The `size_tier` must be one of: 'small', 'medium', 'large'.\n- If you cannot extract the required info, return an empty JSON object: `{{}}`.\n\n### Feature Type Menu:\n{type_list_str}\n\n### Original Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:",
    "task_prompt_ch_fix_procgen": "You are in a strict editing mode. Your task is to repair the following text so it is a valid JSON object. Do not add any new information. Respond with ONLY the corrected JSON object.\n\n### Corrupted Text:\n{raw_text}",
    "task_prompt_ch_fix_tile_json": "The following text was meant to be a single JSON object defining a new tile type, but it is broken. Your task is to fix it and infer any missing values based on the rules.\n\n### JSON Schema Rules:\n- The root must be a single object where the key is the new tile's uppercase name (e.g., `\"MY_TILE\": {{...}}`).\n- The inner object must contain these keys:\n  - `description`: (string) A one-sentence description.\n  - `movement_cost`: (float) e.g., 1.0, 1.5, 2.0.\n  - `is_transparent`: (boolean) Almost always `true`.\n  - `materials`: (list of strings) Choose one or more from: {materials_list}.\n  - `pass_methods`: (list of strings) Choose one or more from: {pass_methods_list}.\n  - `colors`: (list of lists) Must contain one [R, G, B] list. e.g., `[[100, 100, 100]]`.\n  - `characters`: (list of strings) Must contain one single character string. e.g., `[\".\"]`\n\n### Original Corrupted Text:\n---\n{raw_text}\n---\n\n### Your Corrected JSON Output:"
}