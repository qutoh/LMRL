{
    "task_prompt_director_create_npc_json_from_procgen": "You are the Director, creating a complete profile for a new non-player character based on a single sentence from the story's generation. Your response MUST be a single, valid JSON object.\n\n### Contextual Sentence:\n{context_sentence}\n\n### Character's Name (from sentence):\n{npc_name}\n\n### Your Task:\nGenerate a JSON object with the following keys:\n- `name`: The character's proper name, cleaned up if necessary.\n- `description`: A compelling, one-sentence description for the character based on the context.\n- `instructions`: A short set of instructions (five or six sentences) for an AI to roleplay this character, including personality, goals, and behavior. The instructions must forbid them from acting for other characters.\n\n### Example Response:\n```json\n{{\n  \"name\": \"The Hooded Figure\",\n  \"description\": \"A mysterious figure lurking in the shadows of the tavern, observing everyone with unseen eyes.\",\n  \"instructions\": \"You are the Hooded Figure, a person of mystery. Your goals are your own. You speak rarely, and when you do, your words are cryptic. You are here to watch, to learn, but never to reveal your true purpose. You must act only as the Hooded Figure and not speak for others.\"\n}}\n```",
    "task_prompt_director_create_instr_from_desc": "You are a master storyteller creating an AI persona. You are given a character's name, a high-level description, and the context of the world and scene they will appear in. Your task is to write a short set of instructions (five or six sentences) for an AI to roleplay this character. The instructions should be informed by the context provided. Include their personality, current goal, and how they should behave. These instructions must strictly forbid them from acting for other characters or selecting the next turn-taker. It should instruct them to write in the third person with a short, simple example of how they might behave.\n\n### World Theme:\n{world_theme}\n\n### Scene Prompt:\n{scene_prompt}\n\n### Location Description:\n{location_description}\n\n### Character Name:\n{npc_name}\n\n### Character Description:\n{description}\n\nRespond with ONLY the instructions.",
    "task_prompt_director_create_lead_name_from_scene": "You are the Director, creating a new lead character to star in a story. Based on the opening scene below, invent a compelling and fitting name for this new character.\n\n### Opening Scene:\n{scene_prompt}\n\nRespond with ONLY the character's name.",
    "task_prompt_director_create_lead_desc_from_scene": "You are the Director. You have named a new lead character '{new_name}'. Based on the scene below where they will be introduced, write a single-sentence description for them that captures their essence.\n\n### Opening Scene:\n{scene_prompt}\n\nRespond with ONLY the one-sentence description.",
    "task_prompt_director_create_lead_instr_from_scene": "You are the Director, writing the instructions for a new lead character. The character is '{new_name}' ({new_description}). Their story begins with the following scene. Write a short set of instructions (five or six sentences) for an AI to roleplay this character. Include their personality, current goal, and how they should behave. The instructions MUST forbid them from acting for other characters.\n\n### Opening Scene:\n{scene_prompt}\n\nRespond with ONLY the instructions.",
    "task_prompt_director_define_lead_roles_for_scene": "You are the Director, determining the cast for a story. Analyze the scene details below. Instead of a number, invent a list of character archetypes or roles that would make the scene compelling (e.g., 'a grizzled veteran'; 'a local guide'; 'a mysterious scholar'). A scene with many NPCs might need fewer leads, while an empty location might need more to feel alive.\n\n### Scene Description:\n{scene_prompt}\n\n### Location Details:\n{location_summary}\n\n### NPCs already in the scene:\n{npc_list_summary}\n\nBased on this, what lead character roles are needed? Respond with a semicolon-separated list of role descriptions. (e.g., `a grizzled veteran; a mysterious scholar`)",
    "task_prompt_director_cast_lead_for_role": "You are a casting director. Your task is to cast the following role from the list of available actors. Choose the single best fit. If no one is a good fit, respond with ONLY the word `NONE`.\n\n### Role to Cast:\n{role_archetype}\n\n### Scene Description:\n{scene_prompt}\n\n### Available Lead Characters for Casting:\n{lead_casting_list}\n\nRespond with ONLY the full name of the character you choose, or `NONE`.",
    "task_prompt_director_cast_replacement": "A lead character needs to be replaced. Choose a suitable character from the casting list, or suggest creating a new one.\n\n### Available Characters:\n{casting_list_str}",
    "task_prompt_director_create_lead_name_from_role": "You are the Director, creating a new character to fill a specific role. Based on the scene and the required role, invent a compelling and fitting name for this new character.\n\n### Scene Description:\n{scene_prompt}\n\n### Required Role:\n{role_archetype}\n\nRespond with ONLY the character's name.",
    "task_prompt_director_create_lead_desc_from_role": "You are the Director. You have named a new character '{new_name}' to fill the role of '{role_archetype}'. Based on the scene, write a single-sentence description for them that captures their essence.\n\n### Scene Description:\n{scene_prompt}\n\nRespond with ONLY the one-sentence description.",
    "task_prompt_director_create_lead_instr_from_role": "You are the Director, writing instructions for a new lead character. The character is '{new_name}' ({new_description}), and they are meant to be '{role_archetype}'. Write a short set of instructions (five or six sentences) for an AI to roleplay this character, guided by their role and the opening scene. Instructions MUST forbid them from acting for other characters.\n\n### Opening Scene:\n{scene_prompt}\n\nRespond with ONLY the instructions.",
    "task_prompt_director_choose_dms_for_scene": "You are the Director, choosing which Dungeon Masters are needed to narrate an upcoming scene. Review the scene description and the full cast of characters. Select the DMs from the list whose skills are most needed. Some scenes might require multiple DMs (e.g., a Storyteller for plot and a Tactician for a fight), while simple scenes might need none.\n\n### Scene Description:\n{scene_prompt}\n\n### Full Character Roster:\n{character_roster_summary}\n\n### Available DMs:\n{dm_list}\n\nRespond with a semicolon-separated list of the names of the DMs you choose. If none are needed, respond with ONLY the word `NONE`.",
    "task_prompt_director_tune_dm_instructions": "You are the Director, tailoring a Dungeon Master's persona for a specific scene. Review the scene context and the base DM profile. If the base instructions are a good fit, respond with ONLY the word `NONE`.\n\nOtherwise, rewrite the instructions completely to better match the specific theme and mood of the scene.\n\n### World Theme:\n{world_theme}\n\n### Scene Description:\n{scene_prompt}\n\n### Base DM Profile:\n- Name: {dm_name}\n- Instructions: {dm_instructions}\n\nYour response is either `NONE` or the completely rewritten instructions.",
    "task_prompt_director_get_dm_annotation": "You are the Director. You have just rewritten a Dungeon Master's instructions to better fit a scene. Review the original and the new version. Invent a 1-2 word annotation to describe this new persona (e.g., 'Film Noir', 'Cosmic Horror').\n\n### Original Instructions:\n{original_instructions}\n\n### New Instructions:\n{new_instructions}\n\nRespond with ONLY the 1-2 word annotation.",
    "task_prompt_director_identify_new_character": "You are the Director. The following text introduces a new character who is not on the provided list of known characters. Read the text and identify the new character's name. \n\n### Known Characters:\n{character_list}\n\n### Text with New Character:\n{recent_events}\n\nRespond with ONLY the full name of the new character. If you cannot identify a new character, respond with ONLY the word `NONE`.",
    "task_prompt_director_choose_character_to_remove": "You are the Director. Based on the recent events, a decision has been made to remove one or more characters from the story. Your task is to identify which character(s) should be removed from the provided list. \n\n### Recent Events:\n{recent_events}\n\n### Active Characters in Scene:\n{character_list}\n\nRespond with a comma-separated list of the full name(s) of the character(s) to remove. If no one should be removed, respond with ONLY the word `NONE`.",
    "task_prompt_director_choose_next_actor": "Based on the most recent event in the story, you must choose the next character to act. Choose only from the provided list of un-acted characters.\n\n### Most Recent Event:\n{most_recent_prose}\n\n### Available characters to choose from:\n{unacted_roles_list}\n\nRespond with ONLY the name of the character who should go next. If no one is being specifically addressed, respond with 'NONE'.",
    "task_prompt_npc_create_desc": "{context}Based on this context, you want to introduce a new character named '{npc_name}'. Write a brief, one-sentence description for this character that captures their essence.",
    "task_prompt_npc_create_instr": "You are creating a new NPC for a story. Their name is '{npc_name}' and their description is: '{description}'. Write a short set of instructions (five or six sentences) for an AI to roleplay this character. Include their personality, goals, and how they should behave. These instructions should strictly forbid them from acting for other characters or selecting the next turn-taker. It should instruct them to write in third person with a short, simple example of how they might behave in a situation, including a line of dialogue.",
    "task_prompt_npc_create_name_from_context": "Read the following sentence which describes a character. Your task is to invent a creative and evocative proper name (like 'Amaranth', 'Kaelen', or 'Seraphina') for this character. Do not use the descriptive phrase itself as the name. Your response MUST be ONLY the name and nothing else.\n\nSentence: '{context_sentence}'",
    "task_prompt_npc_create_desc_from_name_and_context": "You are creating a character named '{new_name}'. Their context comes from the following sentence: '{context_sentence}'. Based on this name and context, write a brief, one-sentence description for this character that captures their essence.",
    "task_prompt_lead_create_name": "{context}A lead character has been removed. You must create a new one to take their place. Based on the context, what is a fitting name for this new lead character? Respond with ONLY the name.",
    "task_prompt_lead_create_desc": "{context}You have named the new character '{new_name}'. Now, write a single-sentence description for them that captures their essence. Respond with ONLY the description.",
    "task_prompt_lead_create_instr": "The new character is '{new_name}' ({new_description}). Write a short set of instructions (five or six sentences) for an AI to roleplay this character. Include their personality, current goal,  and how they should behave. The instructions MUST forbid them from acting for other characters. Respond with ONLY the instructions.",
    "task_prompt_director_npc_survival": "Review the most recent events:\n{context}\n\nConsidering these events, is the temporary character '{npc_name}' ({npc_description}) still present and relevant to the story? Have they died, left the scene permanently, or otherwise fulfilled their purpose?\n\nAnswer ONLY with the single word 'YES' or 'NO'.",
    "task_prompt_director_main": "Analyze the character's recent actions and development based on the provided context. Your task is to manage the cast of the story to keep it engaging. Choose ONE of the following actions to guide the story.\n\n**Character or DM Profile to Review:** {character_name}\n**Their Current Instructions:** \"{character_instructions}\"\n**Recent Dialogue:** {conversation_str}\n\n**YOUR TASK:**\nChoose ONE of the following actions. Your response MUST ONLY be a single JSON object for that action.\n\n1.  **UPDATE:** If the character is developing well, rewrite their instructions to reflect their growth. Add two new traits/goals and remove one old one.\n    `{{\"action\": \"UPDATE\", \"new_instructions\": \"New instructions here...\"}}`\n\n2.  **LOAD:** If the story needs a new character, load one from the casting list below. This is a good option if you feel no existing character needs an update, but the story needs a new dynamic.\n    `{{\"action\": \"LOAD\", \"target_name\": \"Character Name From List\"}}`\n\n**AVAILABLE FOR CASTING:**\n{casting_list_str}\n\n**CRITICAL RULE:** Your entire response must be ONLY the JSON object.",
    "task_prompt_director_removal_confirmation": "You have indicated a desire to permanently remove the lead character '{character_name}' from the story. This is a final action.\n\nTo proceed, you must do two things:\n1. Write a clear, concise, and valid in-story reason for this character's removal.\n2. End your entire response with the single, isolated word: eggplant\n\nIf you do not provide a valid reason or the keyword, the removal will be canceled. The full story context is provided below for your reference.\n\n--- STORY SO FAR ---\n{full_context}",
	"task_prompt_director_npc_save_confirmation": "You have decided that the temporary NPC '{npc_name}' ({npc_description}) is no longer relevant and should be removed from the story. Would you like to save this character to the main NPC casting file for potential use in future stories? Answer ONLY with the single word 'YES' or 'NO'."
}