{
  "task_prompt_director_cast_lead_for_role": "Your task is to cast the following role from the list of available actors. Choose the single best fit. If no one is a good fit, respond with ONLY the word `NONE`.\n\n{prompt_substring_world_scene_context}\n\n### Role to Cast:\n{role_archetype}\n\n### Available Lead Characters for Casting:\n{lead_casting_list}\n\nRespond with ONLY the full name of the character you choose, or `NONE`.",
  "task_prompt_director_cast_replacement": "A lead character needs to be replaced. Choose a suitable character from the casting list, or suggest creating a new one.\n\n{prompt_substring_world_scene_context}\n\n### Available Characters:\n{casting_list_str}",
  "task_prompt_director_choose_character_to_remove": "Based on the recent events, a decision has been made to remove one or more characters from the story. Your task is to identify which character(s) should be removed from the provided list. \n\n### Recent Events:\n{recent_events}\n\n### Active Characters in Scene:\n{character_list}\n\nRespond with a comma-separated list of the full name(s) of the character(s) to remove. If no one should be removed, respond with ONLY the word `NONE`.",
  "task_prompt_director_choose_dms_for_scene": "You are choosing which Dungeon Masters are needed to narrate an upcoming scene. Review the scene description and the full cast of characters. Select the DMs from the list whose skills are most needed.\n\n{prompt_substring_world_scene_context}\n\n### Full Character Roster:\n{character_roster_summary}\n\n### Available DMs:\n{dm_list}\n\nRespond with a semicolon-separated list of the names of the DMs you choose. If none are needed, respond with ONLY the word `NONE`.",
  "task_prompt_director_choose_next_actor": "Based on the most recent event in the story, you must choose the next character to act. Choose only from the provided list of un-acted characters.\n\n### Most Recent Event:\n{most_recent_prose}\n\n### Available characters to choose from:\n{unacted_roles_list}\n\nRespond with ONLY the name of the character who should go next. If no one is being specifically addressed, respond with 'NONE'.",
  "task_prompt_director_choose_dm_to_unfuse": "The current Game Master is a fusion of the following roles. Choose the single role you would like to remove to simplify the persona.\n\n### Component DM Roles:\n{component_dm_list}\n\nRespond with ONLY the name of the DM role to remove.",
  "task_prompt_director_create_persona_desc": "You are creating the core identity for an AI roleplaying character. Based on their name and description, write a single, first-person sentence that begins with 'You are...'. This will be their base persona.\n\n### Character Name:\n{character_name}\n\n### Character Description:\n{character_description}\n\nRespond with ONLY the single 'You are...' sentence.",
  "task_prompt_director_create_full_lead_profile_from_role": "You are creating a complete profile for a new lead character to fit a specific role in the story. Your response MUST be a single, valid JSON object.\n\n{prompt_substring_world_scene_context}\n\n### Required Role / Archetype:\n{role_archetype}\n\n{full_json}",
  "task_prompt_director_create_full_npc_profile": "You are creating a complete profile for a new non-player character based on a single sentence from the story's generation. Your response MUST be a single, valid JSON object.\n\n{prompt_substring_world_scene_context}\n\n### Contextual Sentence:\n{context_sentence}\n\n{full_json}",
  "task_prompt_director_create_instr_from_desc": "You are creating behavioral directives for an AI character. You are given their name, description, and context. Your task is to write 3-5 directives for the AI to follow. The directives should be written in the second person and focus on goals and personality. DO NOT state who the character is.\n\n{prompt_substring_world_scene_context}\n\n### Location Description:\n{location_description}\n\n### Character Name:\n{npc_name}\n\n### Character Description:\n{description}\n\nRespond with ONLY the directives.",
  "task_prompt_director_create_lead_desc_from_role": "You have named a new character '{new_name}' to fill the role of '{role_archetype}'. Based on the scene, write a single-sentence description for them that captures their essence.\n\n{prompt_substring_world_scene_context}\n\nRespond with ONLY the one-sentence description.",
  "task_prompt_director_create_lead_desc_from_scene": "You have named a new lead character '{new_name}'. Based on the scene below where they will be introduced, write a single-sentence description for them that captures their essence.\n\n{prompt_substring_world_scene_context}\n\nRespond with ONLY the one-sentence description.",
  "task_prompt_director_create_lead_instr_from_role": "You are writing behavioral directives for a new lead character. The character is '{new_name}' ({new_description}), and they are meant to be '{role_archetype}'. Write 3-5 directives for the AI, guided by their role and the opening scene. Focus on personality, goals, and rules (like not acting for others). DO NOT state who the character is, only what they should do.\n\n{prompt_substring_world_scene_context}\n\nRespond with ONLY the directives.",
  "task_prompt_director_create_lead_instr_from_scene": "You are writing behavioral directives for a new lead character. The character is '{new_name}' ({new_description}). Their story begins with the following scene. Write 3-5 directives for the AI to follow. Include their personality, current goal, and how they should behave. The instructions MUST forbid them from acting for other characters. DO NOT state who the character is.\n\n{prompt_substring_world_scene_context}\n\nRespond with ONLY the directives.",
  "task_prompt_director_create_lead_name_from_role": "You are creating a new character to fill a specific role. Based on the scene and the required role, invent a compelling and fitting name for this new character.\n\n{prompt_substring_world_scene_context}\n\n### Required Role:\n{role_archetype}\n\nRespond with ONLY the character's name.",
  "task_prompt_director_create_lead_name_from_scene": "You are creating a new lead character to star in a story. Based on the opening scene below, invent a compelling and fitting name for this new character.\n\n{prompt_substring_world_scene_context}\n\nRespond with ONLY the character's name.",
  "task_prompt_director_create_lead_phys_desc_from_role": "You are creating a new character, '{new_name}' ({new_description}), to fill the role of '{role_archetype}'. Based on the scene, write a one or two-sentence physical description for them.\n\n{prompt_substring_world_scene_context}\n\n{equipment_instruction}\n\nRespond with ONLY the physical description.",
  "task_prompt_director_define_lead_roles_for_scene": "You are determining the cast for a story. Analyze the scene details below. Invent a list of character archetypes or roles that would be in the scene. Keep the cast limited to three or four characters including NPCs. If a character is mentioned in the scene that should be part of the cast and is not already an NPC, include any details given such as name, age, gender, what they are doing, etc.\n\n{prompt_substring_world_scene_context}\n\n### Location Details:\n{location_summary}\n\n### NPCs already in the scene (do not add):\n{npc_list_summary}\n\nBased on this, what lead character roles are needed? Respond with a semicolon-separated list of role descriptions. (e.g., `a grizzled veteran; a mysterious scholar`)",
  "task_prompt_director_get_dm_annotation": "You have just rewritten a Dungeon Master's instructions to better fit a scene. Review the original and the new version. Invent a 1-2 word annotation to describe this new persona (e.g., 'Film Noir', 'Cosmic Horror').\n\n{prompt_substring_world_scene_context}\n\n### Original Instructions:\n{original_instructions}\n\n### New Instructions:\n{new_instructions}\n\nRespond with ONLY the 1-2 word annotation.",
  "task_prompt_director_identify_new_character": "The following text introduces a new character who is not on the provided list of known characters. Read the text and identify the new character's name. \n\n### Known Characters:\n{character_list}\n\n### Text with New Character:\n{recent_events}\n\nRespond with ONLY the full name of the new character. If you cannot identify a new character, respond with ONLY the word `NONE`.",
  "task_prompt_director_main": "Analyze the character's recent actions and development based on the provided context. Your task is to manage the cast of the story to keep it engaging. Choose ONE of the following actions to guide the story.\n\n{prompt_substring_world_scene_context}\n\n**Character or DM Profile to Review:** {character_name}\n**Their Current Instructions:** \"{character_instructions}\"\n**Recent Dialogue:** {conversation_str}\n\n**YOUR TASK:**\nChoose ONE of the following actions. Your response MUST ONLY be a single JSON object for that action.\n\n1.  **UPDATE:** If the character is developing well, rewrite their instructions to reflect their growth. Add two new traits/goals and remove one old one.\n    `{{\"action\": \"UPDATE\", \"new_instructions\": \"New instructions here...\"}}`\n\n2.  **LOAD:** If the story needs a new character, load one from the casting list below. This is a good option if you feel no existing character needs an update, but the story needs a new dynamic.\n    `{{\"action\": \"LOAD\", \"target_name\": \"Character Name From List\"}}`\n\n3.  **UNFUSE_DM:** If the current DM is a fusion of multiple roles, this action allows you to simplify it by removing one of its components.\n    `{{\"action\": \"UNFUSE_DM\"}}`\n\n**AVAILABLE FOR CASTING:**\n{casting_list_str}\n\n**CRITICAL RULE:** Your entire response must be ONLY the JSON object.",
  "task_prompt_director_npc_save_confirmation": "You have decided that the temporary NPC '{npc_name}' ({npc_description}) is no longer relevant and should be removed from the story. Would you like to save this character to the main NPC casting file for potential use in future stories? Answer ONLY with the single word 'YES' or 'NO'.",
  "task_prompt_director_should_spawn_inhabitant": "A group of adventurers are currently exploring the area. Based on their location, decide if a specific local inhabitant should appear now. The goal is to introduce characters only when it's narratively appropriate.\n\n### Inhabitant to consider:\n- Name: {character_name}\n- Description: {character_description}\n\n### Adventurers are currently in or near these locations:\n{visible_locations_list}\n\n### Your Decision:\nShould this inhabitant appear now? If so, in which of the listed locations? Respond with a single JSON object.\n- If they should appear: `{{\"spawn\": true, \"location_name\": \"<Chosen Location Name>\"}}`\n- If they should not appear yet: `{{\"spawn\": false}}`",
  "task_prompt_director_tune_dm_instructions": "You are tailoring a Dungeon Master's persona for a specific scene. Review the scene context and the base DM profile. If the base instructions are a good fit, respond with ONLY the word `NONE`.\n\n{prompt_substring_world_scene_context}\n\n### Base DM Profile:\n- Name: {dm_name}\n- Instructions: {dm_instructions}\n\nYour response is either `NONE` or the completely rewritten instructions.",
  "task_prompt_director_update_physical_description": "A character's equipment has changed. Your task is to rewrite their physical description to reflect these changes. Do not simply list the changes; integrate them naturally into a new, cohesive, and internally consistent description.\n\n### Original Physical Description:\n{original_description}\n\n### Items Added:\n{items_added}\n\n### Items Removed:\n{items_removed}\n\n IMPORTANT: Do not mention previous states, consider their new state based only on characteristics that would be visible (eg, if they are no longer unclothed, do not mention nudity.)\n\nRespond with ONLY the new, rewritten physical description."
}